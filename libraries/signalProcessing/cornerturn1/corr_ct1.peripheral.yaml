schema_name   : args
schema_version: 1.0
schema_type   : peripheral

hdl_library_name       : corr_ct1
hdl_library_description: "Correlator Corner Turn 1 configuration"

peripherals:

  - peripheral_name        : corr_ct1
    peripheral_description : "Correlator corner turn 1 configuration"

    slave_ports:
      - slave_name        : config
        slave_type        : reg
        number_of_slaves  : 1
        slave_description : "Correlator corner turn 1 control"
        fields:
          - - field_name        : status
              width             : 32
              access_mode       : RO
              reset_value       : 0x0
              field_description : "status. "

          - - field_name        : output_cycles
              width             : 16
              access_mode       : RW
              reset_value       : 0x1004
              field_description : "Number of clock cycles from the start of one output packet to the start of the next packet.\
                                   Actual packet length is 4096 clocks. Default is 4100."
              
          - - field_name        : framecount_start
              width             : 7
              access_mode       : RW
              reset_value       : 0x10
              field_description : "Reading of a buffer will start when a packet count with this offset within a buffer or greater \
                                   is received for the next buffer." 
          
          - - field_name        : input_packets
              width             : 32
              access_mode       : RO
              reset_value       : 0x0
              field_description : "Number of input packet notifications received from LFAA ingest module"
          
          - - field_name        : integration_count
              width             : 32
              access_mode       : RO
              reset_value       : 0x0
              field_description : "The integration interval that we are currently writing data for.\
                                   Integration intervals are 849ms blocks of data, and this value counts from the start of the SPS epoch."

          - - field_name        : active_table
              width             : 1
              access_mode       : RO
              reset_value       : 0x0
              field_description : "Which table is currently used by the corner turn? Do not change contents of that table unless in reset."        
        
          - - field_name        : table0_valid
              width             : 1
              access_mode       : RW
              reset_value       : 0x0
              field_description : "Indicates that delay table 0 contains valid data. Table 0 delays will be used if \
                                   the table is valid, the current packet being processed is greater than or equal to \
                                   table0_startpacket and table 0 is more recent than table 1, if table 1 is also valid"
              
          - - field_name        : table0_startPacket_low
              width             : 32
              access_mode       : RW
              reset_value       : 0x0
              field_description : "low 32 bits of the packet count that the fine delay values in table_0 are referenced to. \
                                   table 0 is used when the actual packet count passes this value"
        
          - - field_name        : table0_startPacket_high
              width             : 16
              access_mode       : RW
              reset_value       : 0x0
              field_description : "High 16 bits for the packet count that table0 becomes valid at"
          
          - - field_name        : table0_ns_offset
              width             : 32
              access_mode       : RW
              reset_value       : 0x0
              field_description : "ns offset to be used for delay polynomial evaluation for delay table 0."
          
          - - field_name        : table1_valid
              width             : 1
              access_mode       : RW
              reset_value       : 0x0
              field_description : "Indicates that delay table 1 contains valid data. Table 1 delays will be used if \
                                   the table is valid, the current packet being processed is greater than or equal to \
                                   table1_startpacket and table 1 is more recent than table 0, if table 0 is also valid"
              
          - - field_name        : table1_startPacket_low
              width             : 32
              access_mode       : RW
              reset_value       : 0x0
              field_description : "low 32 bits of the packet count that the fine delay values in table_1 are referenced to. \
                                   table 0 is used when the actual packet count passes this value"
        
          - - field_name        : table1_startPacket_high
              width             : 16
              access_mode       : RW
              reset_value       : 0x0
              field_description : "High 16 bits for the packet count that table1 becomes valid at"
          
          - - field_name        : table1_ns_offset
              width             : 32
              access_mode       : RW
              reset_value       : 0x0
              field_description : "ns offset to be used for delay polynomial evaluation for delay table 1."
          
          - - field_name        : table_0
              width             : 32
              number_of_fields  : 4096
              access_mode       : RW
              field_description : "Coarse and fine delay values - Table 0. \
                                    Each virtual channel C has 4 words, at addresses 4C, 4C+1, 4C+2, 4C+3. \
                                    Word 0, bits 10:0 = Coarse Delay, bits 31:16 = Hpol DeltaP. \
                                    Word 1, bits 15:0 = Vpol DeltaP, bits 31:16 = DeltaDelta P (common to both polarisations).\
                                    Word 2, bits 15:0 = Hpol phase offset for the center frequency, bits(31:16) = Vpol phase offset for the center frequency. \
                                    Word 3, bits 31:0 = step in the phase offset for the center frequency per output packet. This is common to both polarisations. \
                                    See confluence documentation for details. \
                                    TO BE UPDATED TO CONTAIN DELAY POLYNOMIALS "

          - - field_name        : table_1
              width             : 32
              number_of_fields  : 4096
              access_mode       : RW
              field_description : "Coarse delay values - Table 1. As per the definition for table_0."

          - - field_name        : early_or_late_count
              width             : 32
              access_mode       : RO
              reset_value       : 0x0
              field_description : "Count of SPS packets dropped due to being outside the time window for expected packets."

          - - field_name        : pre_latch_on_count
              width             : 32
              access_mode       : RO
              reset_value       : 0x0
              field_description : "Number of packets dropped while waiting to latch on to the incoming data stream"

          - - field_name        : duplicates_count
              width             : 32
              access_mode       : RO
              reset_value       : 0x0
              field_description : "Count of duplicate input packets (i.e. input packets with the same timestamp and channel as a previous packet)."

          - - field_name        : missing_count
              width             : 32
              access_mode       : RO
              reset_value       : 0x0
              field_description : "Count of SPS packets on the filterbank read out with no data."
              
          - - field_name        : buffers_sent_count
              width             : 32
              access_mode       : RO
              reset_value       : 0x0
              field_description : "total number of 283ms buffers read out and sent to the filterbanks."

          - error:
            - field_name        : input_overflow
              width             : 1
              access_mode       : RO
              reset_value       : 0x0
              field_description : "input buffer has overflowed."
          
            - field_name        : read_overflow
              width             : 1
              access_mode       : RO
              reset_value       : 0x0
              field_description : "Readout was triggered, but the previous readout was still running"
              
          - - field_name        : correlator_output_count
              width             : 32
              number_of_fields  : 1024
              access_mode       : RO
              field_description : "Number of valid input blocks read for each channel."

